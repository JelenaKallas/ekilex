<!DOCTYPE html>
<html lang="et" xmlns:th="http://www.thymeleaf.org">
<head th:replace="common :: common_header(~{::title},~{::links})">
<title th:text="#{lex.search.title}">EKILEX otsing</title>
<th:block th:fragment="links">
  <script type="text/javascript" th:src="@{/view/js/ekilex-lexsearch.js}"></script>
  <script type="text/javascript" th:src="@{/view/js/ekilex-editor.js}"></script>
</th:block>
</head>
<body class="body-with-navbar">
  <th:block th:replace="common :: nav_bar(activeItem = 'lex')"></th:block>

  <div class="container-fluid">
    <div class="card shadow">
      <div class="card-body p-2">
        <form th:action="@{/lexsearch}" method="post">
          <th:block th:replace="search :: search_form('lex_search')"></th:block>
        </form>
      </div>
    </div>

    <div class="mt-4 float-left" th:if="${#lists.isEmpty(wordsFoundBySearch) && (simpleSearchFilter != null)}">
      <div th:text="#{lex.not.found}">Not found.</div>
    </div>

    <div class="row no-gutters mt-2">
      <div class="col-3 pr-2" style="height: calc(100vh - 12rem); overflow-y: auto;">
        <div class="card shadow" th:if="${not #lists.isEmpty(wordsFoundBySearch)}">
          <div class="card-body p-2">
            <a href="/" id="show-all-btn"><span th:text="${'Kokku leiti : ' + totalCount}"></span></a>
            <table id="results" class="table table-striped mb-0">
              <tr th:each="word : ${wordsFoundBySearch}">
                <td class="p-0">
                  <button type="button" class="btn btn-link pt-0" th:data-id="${word.wordId}" name="detailsBtn">
                    <span th:text="${word.value}" class="ttl">vorm 1</span>
                    <span th:text="${word.homonymNumber}" th:if="${word.homonymNumber > 0}"></span>
                    (
                    <span th:text="${word.language}"></span>
                    )
                  </button>
                  <div style="position:relative; top: -10px; padding-left: 10px">
                    <small>
                <span th:each="wordDatasetCode,wordDatasetIter : ${word.datasetCodes}">
                  <span th:text="${wordDatasetCode}"></span>
                  <span th:unless="${wordDatasetIter.last}">,</span>
                </span>
                    </small>
                  </div>
                </td>
              </tr>
            </table>
          </div>
        </div>
      </div>
      <div class="col-9" style="height: calc(100vh - 12rem); overflow-y: auto;">
        <div id="details_div"></div>
      </div>
    </div>
  </div>

  <th:block th:fragment="details" th:if="${details != null}">
    <div th:data-id="${wordId}" id="details_div">
      <button id="refresh-details" hidden th:data-id="${wordId}" name="detailsBtn" data-refresh></button>
      <div class="row no-gutters">
        <div class="col-8 pr-2">
          <div class="card shadow mb-2" th:each="lexeme : ${details.lexemes}">

            <div class="card-body" th:data-toggle-name="${'lexTitle_' + lexeme.lexemeId}">
              <button type="button" class="btn badge badge-secondary float-right btn-toggle"
                      th:data-toggle-target="${'lexBody_' + lexeme.lexemeId}">
                <i class="fa fa-angle-down" aria-hidden="true"></i>
              </button>
              <div class="d-flex flex-row align-items-center flex-wrap">
                <div class="d-flex align-items-center flex-wrap">
                  <span class="ttl" th:each="word,wordIter : ${lexeme.words}"
                        th:text="${word + (wordIter.last ? '' : ', ')}"
                        th:classappend="${wordIter.last ? 'pr-2' : ''}"></span>
                  <th:block th:each="meaningWord,meaningWordIter : ${lexeme.meaningWords}">
                    <div class="btn-custom">
                      <span th:text="${meaningWord.value}"></span>
                      <span th:text="${meaningWord.homonymNumber}"></span>
                      <span th:text="${'( ' + meaningWord.language + ' )'}"></span>
                    </div>
                    <span th:unless="${meaningWordIter.last}">|</span>
                  </th:block>
                  <span th:if="${lexeme.levels != null}"
                        th:data-id="${lexeme.lexemeId}"
                        th:data-level1="${lexeme.level1}"
                        th:data-level2="${lexeme.level2}"
                        th:data-level3="${lexeme.level3}"
                        class="pl-1">
                    <small th:text="${'[ ' + lexeme.levels + ' ]'}"></small>
                  </span>
                </div>
                <div class="ml-auto">
                  <b th:text="${lexeme.dataset}"></b>
                </div>
              </div>
              <div th:if="${not #lists.isEmpty(lexeme.definitions)}">
                <span th:utext="${lexeme.definitions.get(0).value}"></span>
              </div>
            </div>

            <div class="card-body d-none" th:data-toggle-name="${'lexBody_' + lexeme.lexemeId}">
              <button type="button" class="btn badge badge-secondary float-right btn-toggle"
                      th:data-toggle-target="${'lexTitle_' + lexeme.lexemeId}">
                <i class="fa fa-angle-up" aria-hidden="true"></i>
              </button>
              <div class="d-flex flex-row align-items-center flex-wrap">
                <div class="d-flex align-items-center flex-wrap">
                  <span class="ttl" th:each="word,wordIter : ${lexeme.words}"
                        th:text="${word + (wordIter.last ? '' : ', ')}"
                        th:classappend="${wordIter.last ? 'pr-2' : ''}"></span>
                  <th:block th:each="meaningWord,meaningWordIter : ${lexeme.meaningWords}">
                    <button type="button" class="btn btn-link pl-0 pr-0" th:data-id="${meaningWord.wordId}" name="detailsBtn">
                      <span th:text="${meaningWord.value}"></span>
                      <span th:text="${meaningWord.homonymNumber}"></span>
                      <span th:text="${'( ' + meaningWord.language + ' )'}"></span>
                    </button>
                    <span th:unless="${meaningWordIter.last}">|</span>
                  </th:block>
                  <span th:if="${lexeme.levels != null}"
                        th:data-id="${lexeme.lexemeId}"
                        th:data-level1="${lexeme.level1}"
                        th:data-level2="${lexeme.level2}"
                        th:data-level3="${lexeme.level3}"
                        class="btn pl-0" onclick="openLexemeLevelDlg(this)" data-toggle="modal" data-target="#editLexemeLevelsDlg">
                    <small th:text="${'[ ' + lexeme.levels + ' ]'}"></small>
                  </span>
                  <span th:if="${lexeme.wordDisplayMorphCode != null}" th:text="${lexeme.wordDisplayMorphCode}"></span>
                </div>
                <div>
                  <a class="btn btn-primary" th:href="@{'/lexjoin/' + ${lexeme.lexemeId}}">Ühenda</a>
                  <a class="btn btn-primary" th:href="@{'/lexseparate/' + ${lexeme.lexemeId}}" th:if="${!#lists.isEmpty(lexeme.meaningWords)}"
                     data-toggle="confirmation" data-placement="right" data-title="Kas olete kindel, et soovite viia sõna eraldi tähendusse ?"
                    >Lahuta</a>
                  <button class="btn btn-primary" data-toggle="modal" data-target="#newWordDlg" th:data-meaning-id="${lexeme.meaningId}">Lisa uus keelend</button>
                </div>
                <div class="ml-auto">
                  <b th:text="${lexeme.dataset}"></b>
                </div>
              </div>
              <div th:if="${!#lists.isEmpty(lexeme.vocalForms)}">
                <span class="lbl">Hääldus</span>
                <span th:each="vocalForm,vocalFormIter : ${lexeme.vocalForms}">
                    <span th:text="${vocalForm}"></span>
                    <span th:unless="${vocalFormIter.last}">,&nbsp;</span>
                </span>
              </div>
              <div>
                <hr />
                <span class="lbl" th:unless="${lexeme.lexemeOrMeaningClassifiersExist}">Ilmiku omadused</span>
                <button type="button" class="btn badge badge-success float-right" title="Lisa klassifikaator"
                        th:data-lexeme-id="${lexeme.lexemeId}"
                        th:data-meaning-id="${lexeme.meaningId}"
                        th:data-word-id="${wordId}"
                        onclick="openClassifiersDlg(this)"
                        data-toggle="modal" data-target="#lexemeClassifiersDlg">
                  <i class="fa fa-plus" aria-hidden="true"></i>
                </button>
                <th:block th:replace="lexeme_components :: lexeme_parameters"></th:block>
              </div>
              <div>
                <hr />
                <span class="lbl">Seletused</span>
                <button type="button" class="btn badge badge-success" title="Lisa uus"
                        th:data-id="${lexeme.meaningId}"
                        onclick="openEkiEditorAddDlg(this)"
                        data-toggle="modal" data-target="#addNewDefinitionDlg">
                  <i class="fa fa-plus" aria-hidden="true"></i>
                </button>
                <table class="orderable" th:data-op-code="definition" th:if="${not #lists.isEmpty(lexeme.definitions)}">
                  <tr th:each="definition, itemStat : ${lexeme.definitions}" th:data-id="${definition.id}" th:data-orderby="${definition.orderBy}">
                    <td>
                      <th:block th:replace="common :: ordering_buttons(${itemStat})"></th:block>
                    </td>
                    <td class="hidden-buttons">
                      <span th:name="${definition.id} + '_definition'"
                            th:data-id="${definition.id}"
                            th:data-op-code="definition"
                            th:data-value="${definition.value}"
                            th:utext="${definition.value}"></span>
                      <button type="button" class="btn badge badge-primary ml-2"
                              th:title="Muuda" th:data-target-elem="${definition.id} + '_definition'"
                              onclick="openEkiEditorDlg(this)"
                              data-toggle="modal" data-target="#ekiEditorDlg">
                        <i class="fa fa-edit" aria-hidden="true"></i>
                      </button>
                      <button type="button" class="btn badge badge-warning"
                              th:data-target-elem="${definition.id} + '_definition'"
                              data-toggle="delete-confirmation" data-placement="right">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                      </button>
                    </td>
                  </tr>
                </table>
              </div>
              <div>
                <hr />
                <span class="lbl">Allikaviide</span>
                <span th:each="sourceLink : ${lexeme.sourceLinks}" class="hidden-buttons">
                  [
                  <a th:href="@{'/lex_source_link:' + ${sourceLink.id}}"
                     th:name="${sourceLink.id} + '_lex_source_link'"
                     th:data-id="${sourceLink.id}"
                     th:data-op-code="lex_source_link"
                     th:text="${sourceLink.value}"
                  ></a>
                  <span th:if="${sourceLink.name != null}">
                    <span th:text="${sourceLink.name}"></span>
                  </span>
                  <button type="button" class="btn badge badge-warning"
                          th:data-target-elem="${sourceLink.id} + '_lex_source_link'"
                          data-toggle="delete-confirmation" data-placement="right">
                    <i class="fa fa-remove" aria-hidden="true"></i>
                  </button>
                  ]
                </span>
                <button type="button" class="btn badge badge-success" title="Lisa allikaviide"
                        th:data-id="${lexeme.lexemeId}"
                        th:data-op-code="lex_source_link"
                        onclick="openAddSourceLinkDlg(this)"
                        data-toggle="modal" data-target="#addNewSourceLinkDlg">
                  <i class="fa fa-plus" aria-hidden="true"></i>
                </button>
              </div>
              <div th:if="${not #lists.isEmpty(lexeme.meaningFreeforms)}">
                <hr />
                <span class="lbl">Tähenduse atribuudid</span>
                <table>
                  <tr th:each="freeform : ${lexeme.meaningFreeforms}">
                    <td class="align-text-top pr-3">
                      <span th:text="${freeform.type}"></span>
                    </td>
                    <td th:unless="${freeform.type.toString() == 'IMAGE_FILE'}">
                      <span th:utext="${markdown.toHtml(freeform.valueText)}" th:if="${freeform.valueText != null}"></span>
                      <span th:text="${#dates.format(freeform.valueDate, 'dd.MM.yyyy HH:mm')}" th:if="${freeform.valueDate != null}"></span>
                    </td>
                    <td th:if="${freeform.type.toString() == 'IMAGE_FILE'}">
                      <img class="w-100" th:src="@{'/files/images/' + ${freeform.valueText}}">
                    </td>
                  </tr>
                </table>
              </div>
              <div>
                <hr />
                <span class="lbl">Tähenduse seosed</span>
                <button type="button" class="btn badge badge-success" title="Lisa seos"
                        th:data-id="${lexeme.meaningId}"
                        onclick="openAddNewMeaningRelationDlg(this)"
                        data-toggle="modal" data-target="#addNewMeaningRelationDlg">
                  <i class="fa fa-plus" aria-hidden="true"></i>
                </button>
                <table th:if="${not #lists.isEmpty(lexeme.groupedMeaningRelations)}">
                  <tr th:each="relations : ${lexeme.groupedMeaningRelations}"
                      th:data-id="${relations.get(0).id}"
                      th:data-op-code="meaning_relation"
                      th:name="${relations.get(0).id} + '_meaning_relation'"
                      class="hidden-buttons">
                    <td class="pr-3">
                      <th:block th:each="relation, iter : ${relations}">
                        <button type="button" class="btn btn-link p-0" th:data-id="${relation.wordId}" name="detailsBtn">
                          <span th:text="${relation.word + ' ( ' + relation.wordLang + ' )'}"></span>
                        </button>
                        <span th:unless="${iter.last}">,</span>
                      </th:block>
                    </td>
                    <td>
                      <span th:text="${relations.get(0).relationTypeLabel}"></span>
                      <button type="button" class="btn badge badge-warning"
                              th:data-target-elem="${relations.get(0).id} + '_meaning_relation'"
                              data-toggle="delete-confirmation" data-placement="right">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                      </button>
                    </td>
                  </tr>
                </table>
              </div>
              <div>
                <hr />
                <table>
                  <tr>
                    <th class="lbl">Rektsioon
                      <button type="button" class="btn badge badge-success" title="Lisa uus"
                              th:data-id="${lexeme.lexemeId}"
                              onclick="openAddDlg(this)"
                              data-toggle="modal" data-target="#addNewGovernmentDlg">
                        <i class="fa fa-plus" aria-hidden="true"></i>
                      </button>
                    </th>
                  </tr>
                  <tr th:each="government : ${lexeme.governments}">
                    <td class="hidden-buttons">
                      <span th:name="${government.id} + '_government'"
                            th:data-id="${government.id}"
                            th:data-op-code="government"
                            th:data-value="${government.value}"
                            th:text="${government.value}"></span>
                      <button type="button" class="btn badge badge-primary ml-2"
                              th:title="Muuda" th:data-target-elem="${government.id} + '_government'"
                              onclick="openEditDlg(this)"
                              data-toggle="modal" data-target="#editDlg">
                        <i class="fa fa-edit" aria-hidden="true"></i>
                      </button>
                      <button type="button" class="btn badge badge-warning"
                              th:data-target-elem="${government.id} + '_government'"
                              data-toggle="delete-confirmation" data-placement="right">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                      </button>
                    </td>
                  </tr>
                </table>
              </div>
              <div>
                <hr />
                <table>
                  <tr>
                    <th class="lbl">Kasutusnäited, tõlked, seletused
                      <button type="button" class="btn badge badge-success" title="Lisa uus"
                              th:data-id="${lexeme.lexemeId}"
                              onclick="openEkiEditorAddDlg(this)"
                              data-toggle="modal" data-target="#addNewUsageDlg">
                        <i class="fa fa-plus" aria-hidden="true"></i>
                      </button>
                    </th>
                  </tr>
                  <tr th:if="${not #lists.isEmpty(lexeme.usages)}">
                    <td>
                      <table th:each="usage,usageIter : ${lexeme.usages}" class="border">
                        <tr>
                          <td class="hidden-buttons">
                            <span th:name="${usage.id} + '_usage'"
                                  th:data-id="${usage.id}"
                                  th:data-op-code="usage"
                                  th:data-value="${usage.value}"
                                  th:utext="${usage.value}"></span>
                            <span th:if="${usage.typeValue != null}" th:text="'(' + ${usage.typeValue + ')'}"></span>
                            <span th:if="${#lists.isEmpty(usage.authors)}" class="show-on-mouseover">
                              (
                              <button type="button" class="btn badge badge-success" title="Lisa autor/tõlkija"
                                      th:data-id="${usage.id}"
                                      onclick="openUsageAuthorDlg(this)"
                                      data-toggle="modal" data-target="#addNewUsageAuthorDlg">
                                <i class="fa fa-plus" aria-hidden="true"></i>
                              </button>
                              )
                            </span>
                            <span th:if="${not #lists.isEmpty(usage.authors)}">
                              (
                              <span th:each="sourceLink,sourceLinkIter : ${usage.authors}">
                                <span th:text="#{'enum.reference.type.' + ${sourceLink.type}} + ': '"></span>
                                <a th:href="@{'/ff_source_link:' + ${sourceLink.id}}"
                                   th:name="${sourceLink.id} + '_ff_source_link'"
                                   th:data-id="${sourceLink.id}"
                                   th:data-op-code="ff_source_link"
                                   th:text="${sourceLink.value}"
                                   th:if="${sourceLink.value != null}"
                                ></a>
                                <button type="button" class="btn badge badge-warning"
                                        th:data-target-elem="${sourceLink.id} + '_ff_source_link'"
                                        data-toggle="delete-confirmation" data-placement="right">
                                  <i class="fa fa-remove" aria-hidden="true"></i>
                                </button>
                                <span th:unless="${sourceLinkIter.last}">,</span>
                              </span>
                              <button type="button" class="btn badge badge-success" title="Lisa autor/tõlkija"
                                      th:data-id="${usage.id}"
                                      onclick="openUsageAuthorDlg(this)"
                                      data-toggle="modal" data-target="#addNewUsageAuthorDlg">
                                <i class="fa fa-plus" aria-hidden="true"></i>
                              </button>
                              )
                            </span>
                            <span th:if="${not #lists.isEmpty(usage.sourceLinks)}">
                              [
                              <span th:each="sourceLink,sourceLinkIter : ${usage.sourceLinks}">
                                <a th:href="@{'/ff_source_link:' + ${sourceLink.id}}"
                                   th:name="${sourceLink.id} + '_ff_source_link'"
                                   th:data-id="${sourceLink.id}"
                                   th:data-op-code="ff_source_link"
                                   th:text="${sourceLink.value}"
                                   th:if="${sourceLink.value != null}">
                                  <span th:text="${sourceLink.name}" th:if="${sourceLink.name != null}"></span>
                                  <span th:text="${sourceLink.value}" th:if="${sourceLink.value != null}"></span>
                                </a>
                                <span th:unless="${sourceLinkIter.last}">, </span>
                              </span>
                              ]
                            </span>
                            <button type="button" class="btn badge badge-primary ml-2"
                                    th:title="Muuda" th:data-target-elem="${usage.id} + '_usage'"
                                    onclick="openEkiEditorDlg(this)"
                                    data-toggle="modal" data-target="#ekiEditorDlg">
                              <i class="fa fa-edit" aria-hidden="true"></i>
                            </button>
                            <button type="button" class="btn badge badge-warning"
                                    th:data-target-elem="${usage.id} + '_usage'"
                                    data-toggle="delete-confirmation" data-placement="right">
                              <i class="fa fa-remove" aria-hidden="true"></i>
                            </button>
                            <button type="button" class="btn badge badge-success" title="Lisa tõlge või seletus"
                                    th:data-id="${usage.id}"
                                    onclick="openUsageMemberDlg(this)"
                                    data-toggle="modal" data-target="#addNewUsageMemberDlg">
                              <i class="fa fa-plus" aria-hidden="true"></i>
                            </button>
                          </td>
                        </tr>
                        <tr th:each="usageTranslation : ${usage.translations}">
                          <td class="hidden-buttons">
                            <span th:name="${usageTranslation.id} + '_usage_translation'"
                                  th:data-id="${usageTranslation.id}"
                                  th:data-op-code="usage_translation"
                                  th:utext="${usageTranslation.value}"></span>
                            <button type="button" class="btn badge badge-primary ml-2"
                                    th:title="Muuda" th:data-target-elem="${usageTranslation.id} + '_usage_translation'"
                                    onclick="openEkiEditorDlg(this)"
                                    data-toggle="modal" data-target="#ekiEditorDlg">
                              <i class="fa fa-edit" aria-hidden="true"></i>
                            </button>
                            <button type="button" class="btn badge badge-warning"
                                    th:data-target-elem="${usageTranslation.id} + '_usage_translation'"
                                    data-toggle="delete-confirmation" data-placement="right">
                              <i class="fa fa-remove" aria-hidden="true"></i>
                            </button>
                            <button type="button" class="btn badge badge-success" title="Lisa uus"
                                    th:data-id="${usage.id}"
                                    onclick="openUsageMemberDlg(this)"
                                    data-toggle="modal" data-target="#addNewUsageMemberDlg">
                              <i class="fa fa-plus" aria-hidden="true"></i>
                            </button>
                          </td>
                        </tr>
                        <tr th:each="usageDefinition : ${usage.definitions}">
                          <td class="hidden-buttons">
                            <span th:name="${usageDefinition.id} + '_usage_definition'"
                                  th:data-id="${usageDefinition.id}"
                                  th:data-op-code="usage_definition"
                                  th:data-value="${usageDefinition.value}"
                                  th:utext="${usageDefinition.value}"></span>
                            <button type="button" class="btn badge badge-primary ml-2"
                                    th:title="Muuda" th:data-target-elem="${usageDefinition.id} + '_usage_definition'"
                                    onclick="openEkiEditorDlg(this)"
                                    data-toggle="modal" data-target="#ekiEditorDlg">
                              <i class="fa fa-edit" aria-hidden="true"></i>
                            </button>
                            <button type="button" class="btn badge badge-warning"
                                    th:data-target-elem="${usageDefinition.id} + '_usage_definition'"
                                    data-toggle="delete-confirmation" data-placement="right">
                              <i class="fa fa-remove" aria-hidden="true"></i>
                            </button>
                            <button type="button" class="btn badge badge-success" title="Lisa uus"
                                    th:data-id="${usage.id}"
                                    onclick="openUsageMemberDlg(this)"
                                    data-toggle="modal" data-target="#addNewUsageMemberDlg">
                              <i class="fa fa-plus" aria-hidden="true"></i>
                            </button>
                          </td>
                        </tr>
                      </table>
                    </td>
                  </tr>
                </table>
              </div>
              <div th:if="${not #lists.isEmpty(lexeme.lexemeFreeforms)}">
                <hr />
                <span class="lbl">Ilmiku atribuudid</span>
                <table>
                  <tr th:each="freeform : ${lexeme.lexemeFreeforms}">
                    <td class="align-text-top pr-3">
                      <span th:text="${freeform.type}"></span>
                    </td>
                    <td>
                      <span th:utext="${markdown.toHtml(freeform.valueText)}" th:if="${freeform.valueText != null}"></span>
                      <span th:text="${#dates.format(freeform.valueDate, 'dd.MM.yyyy HH:mm')}" th:if="${freeform.valueDate != null}"></span>
                    </td>
                  </tr>
                </table>
              </div>
              <div>
                <hr />
                <span class="lbl">Ilmiku seosed</span>
                <button type="button" class="btn badge badge-success" title="Lisa seos"
                        th:data-id="${lexeme.lexemeId}"
                        onclick="openAddNewLexemeRelationDlg(this)"
                        data-toggle="modal" data-target="#addNewLexemeRelationDlg">
                  <i class="fa fa-plus" aria-hidden="true"></i>
                </button>
                <table class="orderable" th:data-op-code="lexeme_relation" th:if="${not #lists.isEmpty(lexeme.lexemeRelations)}">
                  <tr th:each="relation, itemStat : ${lexeme.lexemeRelations}"
                      th:data-id="${relation.id}"
                      th:data-op-code="lexeme_relation"
                      th:name="${relation.id} + '_lexeme_relation'"
                      th:data-orderby="${relation.orderBy}">
                    <td>
                      <th:block th:replace="common :: ordering_buttons(${itemStat})"></th:block>
                    </td>
                    <td class="hidden-buttons align-text-top pr-3">
                      <button type="button" class="btn btn-link p-0" th:data-id="${relation.wordId}" name="detailsBtn">
                        <span th:text="${relation.word + ' ( ' + relation.wordLang + ' )'}"></span>
                      </button>
                      <button type="button" class="btn badge badge-warning"
                              th:data-target-elem="${relation.id} + '_lexeme_relation'"
                              data-toggle="delete-confirmation" data-placement="left">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                      </button>
                    </td>
                    <td>
                      <span th:text="${relation.relationTypeLabel}"></span>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div class="card-body pt-0" th:if="${not #lists.isEmpty(lexeme.collocationPosGroups)}">
              <span class="lbl">Kollokatsioonid</span>
              <th:block th:each="collocPosGr : ${lexeme.collocationPosGroups}">
                <div class="border rounded p-2">
                  <p th:text="${collocPosGr.code}"></p>
                  <th:block th:each="collocRelGr : ${collocPosGr.relationGroups}">
                    <div class="border rounded p-2">
                      <p>
                        <span th:text="${collocRelGr.name}"></span>
                        <span th:if="${collocRelGr.frequency != null}">
                          &nbsp;
                          <span class="lbl">Sagedus:</span>
                          <span th:text="${collocRelGr.frequency}"></span>
                        </span>
                        <span th:if="${collocRelGr.score != null}">
                          &nbsp;
                          <span class="lbl">Skoor:</span>
                          <span th:text="${collocRelGr.score}"></span>
                        </span>
                      </p>
                      <table>
                        <tr th:each="colloc : ${collocRelGr.collocations}">
                          <td style="padding: 0px 5px 0px 5px">
                            <span th:text="${colloc.value}"></span>
                          </td>
                          <td style="padding: 0px 5px 0px 5px">
                            <span th:each="collocMember,collocMemberIter : ${colloc.collocMembers}">
                              <button type="button" class="btn btn-link" th:data-id="${collocMember.wordId}" name="detailsBtn">
                                <span th:text="${collocMember.word}"></span>
                                <code>
                                  [<span th:text="${collocMember.weight}"></span>]
                                </code>
                              </button>
                              <br th:unless="${collocMemberIter.last}"/>
                            </span>
                          </td>
                          <td style="padding: 0px 5px 0px 5px">
                            <span th:if="${colloc.definition != null}">
                              (<span th:text="${colloc.definition}"></span>)
                            </span>
                          </td>
                          <td style="padding: 0px 5px 0px 5px">
                            <span th:text="${colloc.frequency}"></span>
                          </td>
                          <td style="padding: 0px 5px 0px 5px">
                            <span th:text="${colloc.score}"></span>
                          </td>
                          <td style="padding: 0px 5px 0px 5px">
                            <div th:if="${not #lists.isEmpty(colloc.collocUsages)}">
                              <div th:each="collocUsage : ${colloc.collocUsages}">
                                <i>
                                  <span th:text="${collocUsage}"></span>
                                </i>
                              </div>
                            </div>
                          </td>
                        </tr>
                      </table>
                    </div>
                    <div style="padding: 5px"></div>
                  </th:block>
                </div>
                <div style="padding: 5px"></div>
              </th:block>
            </div>
            <div class="card-body pt-0" th:if="${not #lists.isEmpty(lexeme.secondaryCollocations)}">
              <span class="lbl">Kasutatud kollokatsioonides</span>
              <div class="border rounded p-2">
                <table>
                  <tr th:each="colloc : ${lexeme.secondaryCollocations}">
                    <td style="padding: 0px 5px 0px 5px">
                      <span th:text="${colloc.value}"></span>
                    </td>
                    <td style="padding: 0px 5px 0px 5px">
                      <span th:each="collocMember,collocMemberIter : ${colloc.collocMembers}">
                        <button type="button" class="btn btn-link" th:data-id="${collocMember.wordId}" name="detailsBtn">
                          <span th:text="${collocMember.word}"></span>
                          <code>
                            [<span th:text="${collocMember.weight}"></span>]
                          </code>
                        </button>
                        <br th:unless="${collocMemberIter.last}"/>
                      </span>
                    </td>
                    <td style="padding: 0px 5px 0px 5px">
                      <span th:if="${colloc.definition != null}">
                        (<span th:text="${colloc.definition}"></span>)
                      </span>
                    </td>
                    <td style="padding: 0px 5px 0px 5px">
                      <span th:text="${colloc.frequency}"></span>
                    </td>
                    <td style="padding: 0px 5px 0px 5px">
                      <span th:text="${colloc.score}"></span>
                    </td>
                    <td style="padding: 0px 5px 0px 5px">
                      <div th:if="${not #lists.isEmpty(colloc.collocUsages)}">
                        <div th:each="collocUsage : ${colloc.collocUsages}">
                          <i>
                            <span th:text="${collocUsage}"></span>
                          </i>
                        </div>
                      </div>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>
        <div class="col-4">
          <div class="card shadow pt-3 mb-2">
            <div class="card-body pt-0 pb-0">
              <div class="lbl mb-2">Keelendi omadused
              <button type="button" class="btn badge badge-success" title="Lisa omadus"
                      th:data-word-id="${wordId}"
                      onclick="openClassifiersDlg(this)"
                      data-toggle="modal" data-target="#wordClassifiersDlg">
                <i class="fa fa-plus" aria-hidden="true"></i>
              </button>
              </div>
              <th:block th:replace="lexeme_components :: word_parameters"></th:block>
              <hr />
            </div>
            <div class="card-body pt-0 pb-0">
              <span class="lbl">Keelendi seosed</span>
              <button type="button" class="btn badge badge-success" title="Lisa seos"
                      th:data-id="${wordId}"
                      onclick="openAddNewWordRelationDlg(this)"
                      data-toggle="modal" data-target="#addNewWordRelationDlg">
                <i class="fa fa-plus" aria-hidden="true"></i>
              </button>
              <table class="orderable" th:data-op-code="word_relation" th:if="${not #lists.isEmpty(details.wordRelations)}">
                <tr th:each="relation, itemStat : ${details.wordRelations}"
                    th:data-id="${relation.id}"
                    th:data-orderby="${relation.orderBy}"
                    th:data-op-code="word_relation"
                    th:name="${relation.id} + '_word_relation'">
                  <td style="display: flex">
                    <th:block th:replace="common :: ordering_buttons(${itemStat})"></th:block>
                  </td>
                  <td class="align-text-top pr-3 pt-0 pb-0 hidden-buttons">
                    <button type="button" class="btn btn-link btn-text-wrap p-0" th:data-id="${relation.wordId}" name="detailsBtn">
                      <span th:text="${relation.word + ' ( ' + relation.wordLang + ' )'}"></span>
                    </button>
                    <button type="button" class="btn badge badge-warning"
                            th:data-target-elem="${relation.id} + '_word_relation'"
                            data-toggle="delete-confirmation" data-placement="left">
                      <i class="fa fa-remove" aria-hidden="true"></i>
                    </button>
                  </td>
                  <td>
                    <span th:text="${relation.relationTypeLabel}"></span>
                  </td>
                </tr>
              </table>
              <table th:if="${not #lists.isEmpty(details.wordGroups)}">
                <tr th:each="wordGroup : ${details.wordGroups}">
                  <td class="align-text-top pr-3 pt-0 pb-0 hidden-buttons">
                    <span th:each="relation, itemStat : ${wordGroup.members}"
                         th:data-id="${relation.id}"
                         th:data-op-code="word_relation"
                         th:name="${relation.id} + '_word_relation_member'">
                      <button type="button" class="btn btn-link p-0" th:data-id="${relation.wordId}" name="detailsBtn">
                        <span th:text="${relation.word}"></span>
                      </button>
                      <button type="button" class="btn badge badge-warning"
                              th:data-target-elem="${relation.id} + '_word_relation_member'"
                              data-toggle="delete-confirmation" data-placement="left">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                      </button>
                      <span th:unless="${itemStat.last}">,</span>
                    </span>
                  </td>
                  <td>
                    <span th:text="${wordGroup.groupTypeLabel}"></span>
                  </td>
                </tr>
              </table>
              <hr />
            </div>
            <div class="card-body pt-0 pb-0" th:if="${not #lists.isEmpty(details.wordEtymology)}">
              <span class="lbl">Keelendi etümoloogia</span>
              <table class="orderable" th:data-op-code="word_etymology">
                <tr th:each="wordEtym, itemStat : ${details.wordEtymology}" th:data-id="${wordEtym.wordEtymologyId}" th:data-orderby="${wordEtym.orderBy}">
                  <td style="display: flex">
                    <th:block th:replace="common :: ordering_buttons(${itemStat})"></th:block>
                  </td>
                  <td class="align-text-top pr-3 pt-0 pb-0">
                    <button type="button" class="btn btn-link p-0" th:data-id="${wordEtym.wordId}" name="detailsBtn">
                      <span>
                        <span th:text="${wordEtym.word + ' ( ' + wordEtym.wordLang + ' )'}"></span>
                        <span th:if="${wordEtym.questionable}">?</span>
                        <span th:if="${wordEtym.compound}">+</span>
                      </span>
                    </button>
                    <div th:if="${not #lists.isEmpty(wordEtym.comments)}">
                      <div th:each="comment : ${wordEtym.comments}">
                        <i th:text="${comment}"></i>
                      </div>
                    </div>
                  </td>
                </tr>
              </table>
              <hr />
            </div>
            <div class="pb-3" th:if="${not #lists.isEmpty(details.paradigms)}">
              <div th:each="paradigm : ${details.paradigms}" th:if="${paradigm.formsExist}" class="pt-2">
                <button class="btn btn-info ml-3" type="button" data-toggle="collapse" th:data-target="${'#paradigmArea_' + paradigm.paradigmId}">
                  <span th:text="${paradigm.title}"></span>
                </button>
                <div th:id="${'paradigmArea_' + paradigm.paradigmId}" class="collapse p-1">
                  <div th:if="${not #lists.isEmpty(paradigm.forms)}">
                    <table>
                      <tr th:each="form : ${paradigm.forms}">
                        <td style="text-align: right; width: 200px">
                          <span th:text="${form.morphCode + ' - ' + form.morphValue}" th:if="${form.displayMorphCode}" style="font-size: 80%; color: #999"></span>
                        </td>
                        <td>
                          <span th:text="${form.value}"></span>
                        </td>
                        <td>
                          <span th:text="${form.displayForm}" th:unless="${#strings.isEmpty(form.displayForm)}" style="font-size: 80%; color: #999"></span>
                        </td>
                        <td>
                          <span th:text="${form.vocalForm}" th:unless="${#strings.isEmpty(form.vocalForm)}" style="font-size: 80%; color: #999"></span>
                        </td>
                      </tr>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <div class="pb-3">
              <a th:href="@{'/wordlifecyclelog:' + ${wordId}}"
                 data-toggle="modal"
                 data-target="#wordLifecycleLogDlg"
                 class="btn btn-light ml-3"
              >Tegevuste logi</a>
              <div id="wordLifecycleLogDlg" class="modal" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <div class="modal-body" style="max-height: 90vh; overflow-y: auto;"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script th:inline="javascript">
      $('[data-toggle=confirmation]').confirmation(
          {
              btnOkLabel: 'Jah',
              btnCancelLabel: 'Ei'
          }
      );
      $('[data-toggle=delete-confirmation]').confirmation(
          {
              btnOkLabel: 'Jah',
              btnCancelLabel: 'Ei',
              title: 'Kas olete kindel, et soovite eemaldada ?',
              onConfirm: performDelete
          }
      );
      decorateSourceLinks();
    </script>
  </th:block>

  <div th:replace="common :: #editDlg"></div>
  <div th:replace="common :: #editLexemeLevelsDlg"></div>
  <div th:replace="ekilex_editor :: #addNewDefinitionDlg"></div>
  <div th:replace="ekilex_editor :: #addNewUsageDlg"></div>
  <div th:replace="common :: #lexemeClassifiersDlg"></div>
  <div th:replace="common :: #wordClassifiersDlg"></div>
  <div th:replace="common :: #lexemeFrequencyDlg"></div>
  <div th:replace="common :: #lexemePosDlg"></div>
  <div th:replace="common :: #meaningDomainDlg"></div>
  <div th:replace="common :: #addNewGovernmentDlg"></div>
  <div th:replace="common :: newWordDlg('LEX_SEARCH')"></div>
  <div th:replace="ekilex_editor :: #addNewUsageMemberDlg"></div>
  <div th:replace="common :: #detailsDlg"></div>
  <div th:replace="common :: #lexemeDerivDlg"></div>
  <div th:replace="common :: #lexemeRegisterDlg"></div>
  <div th:replace="common :: #lexemeValueStateCodeDlg"></div>
  <div th:replace="common :: #lexemeProcessStateCodeDlg"></div>
  <div th:replace="common :: #wordGenderDlg"></div>
  <div th:replace="common :: #wordTypeDlg"></div>
  <div th:replace="common :: #wordAspectDlg"></div>
  <div th:replace="common :: #addNewSourceLinkDlg"></div>
  <div th:replace="lexeme_components :: #addNewWordRelationDlg"></div>
  <div th:replace="lexeme_components :: #addNewLexemeRelationDlg"></div>
  <div th:replace="lexeme_components :: #addNewMeaningRelationDlg"></div>
  <div th:replace="lexeme_components :: #addNewUsageAuthorDlg"></div>
  <div th:replace="ekilex_editor :: #ekiEditorDlg"></div>

  <script th:inline="javascript">
  	initialise();
  </script>
</body>
</html>
